{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Horizon PowerCLI","text":"<p>The VMware.VimAutomation.HorizonView powershell module provides Connect/Disconnect cmdlets for View API service.</p>"},{"location":"#installation","title":"Installation","text":"<p>Installation instructions can be found within the module listing in the Powershell Gallery.</p>"},{"location":"#getting-started-with-vmware-horizon-cmdlets","title":"Getting Started with VMware Horizon cmdlets","text":"<p>Cmdlets are usually implemented around resource operations. The four basic operations are CREATE, READ, UPDATE and DELETE. This set of operations is known as CRUD. Most of the cmdlets support CRUD which are respectively cmdlets that start with the New/Get/Set/Remove cmdlet verbs but they also may have additional operations.</p> <p>VMware.VimAutomation.HorizonView module provides two commandlets:</p> <ol> <li><code>Connect-HVServer</code>    This cmdlet establishes a connection to the Horizon API service that runs on an instance of the Horizon Connection server.</li> <li><code>Disconnect-HVServer</code>  This cmdlet closes the connection to one or more Horizon API services that run on one or more instances of Horizon Connection servers.</li> </ol>"},{"location":"connect-hvserver/","title":"Connect-HVServer","text":"<p>This cmdlet establishes a connection to the Horizon API service of the Horizon Connection server specified by the -Server parameter. The connect and disconnect operations for a server use a reference counting mechanism. Every server is identified by its connection string which contains a unique server and user name. If there is already an existing connection to the server, a new connection is not established. Instead, the cmdlet returns the object which represents the existing connection. The RefCount property of the object is incremented by one. When a server is disconnected, then its RefCount property is decreased by one. If this number becomes equal to zero, then the server is disconnected.</p> <p>PowerCLI supports a list of default servers on which the Horizon API service runs. The Horizon API service runs on an instance of the Horizon Connection server. When an operation is performed, if the target servers cannot be determined from the specified parameters, the cmdlet runs against the servers in the default server list. </p> <p>The target servers are kept in a global variable called <code>$DefaultHVServers</code>. The variable is of an array type and its initial value is an empty array. When you connect to a server, the server is added at the beginning of the array, unless <code>-NotDefault</code> parameter is specified. When you disconnect from a server, the server is removed from the <code>$DefaultHVServers</code> variable. When all servers are removed from the variable, its value is an empty array.</p>"},{"location":"connect-hvserver/#syntax","title":"Syntax","text":"CredentialDefaultSessionSecret <pre><code>Connect-HVServer    [-Server]  &lt;String&gt; \n                    -Credential  &lt;PSCredential&gt; \n                    [-Domain  &lt;String&gt;] \n                    [-Force] \n                    [-NotDefault] \n                    [CommonParameters] \n</code></pre> <pre><code>Connect-HVServer    [-Server]  &lt;String&gt;\n                    [-Domain  &lt;String&gt;]\n                    [-Force]\n                    [-NotDefault]\n                    [-Password  &lt;SecureString&gt;]\n                    [-User  &lt;String&gt;]\n                    [CommonParameters]\n</code></pre> <pre><code>Connect-HVServer    [-Server]  &lt;String&gt;\n                    -SessionId  &lt;String&gt;\n                    [-Force]\n                    [-NotDefault]\n                    [CommonParameters]\n</code></pre>"},{"location":"connect-hvserver/#parameters","title":"Parameters","text":"Required Parameter Name Type Position Features Description required Server String 1 Specifies the IP or FQDN of the Horizon Connection server on which the Horizon API service runs. required SessionId String named Specifies the ID of an existing Horizon Connection server session that you want to reestablish. optional Force SwitchParameter named Suppresses all user interface prompts during the cmdlet execution such as multiple default servers and invalid certificate action. optional NotDefault SwitchParameter named Specifies that you do not want to save the specified servers as default servers."},{"location":"connect-hvserver/#output","title":"Output","text":"<p>VMware.VimAutomation.HorizonView.Types.V1.ViewServer</p>"},{"location":"connect-hvserver/#examples","title":"Examples","text":""},{"location":"connect-hvserver/#example-1","title":"Example 1","text":"<pre><code>Connect-HVServer -Server server -User username -Password pass -Domain domain\n</code></pre> <p>Connects to the Horizon API service that runs on an instance of a Horizon Connection server by using the User, Password, and Domain parameters.</p>"},{"location":"connect-hvserver/#example-2","title":"Example 2","text":"<pre><code>$cs = Connect-HVServer -Server server -Username user -Password pass -Domain domain;\nConnect-HVServer -Server server -SessionId $cs.SessionSecret\n</code></pre> <p>Connects to the Horizon API service that runs on an instance of a Horizon Connection server with an existing session and returns the Horizon API service object. Username is alias to parameter user.</p>"},{"location":"connect-hvserver/#example-3","title":"Example 3","text":"<pre><code>Connect-HVServer -Server server -User username@domain -Password pass\n</code></pre> <p>Connects to the Horizon API service of a Horizon Connection server by passing the domain as a part of the user name and returns the Horizon API service object.</p>"},{"location":"connect-hvserver/#example-4","title":"Example 4","text":"<pre><code>Connect-HVServer -Server server\n</code></pre> <p>Connects to the Horizon API service that runs on an instance of a Horizon Connection server. The user, domain, and password parameters are prompted for and read by the PowerCLI user interface. Returns the Horizon API service object.</p>"},{"location":"connect-hvserver/#related-commands","title":"Related Commands","text":""},{"location":"connect-hvserver/#hvserver","title":"HVServer","text":"<p>Disconnect-HVServer This cmdlet closes the connection to one or more Horizon API services that run on one or more instances of Horizon Connection servers.</p>"},{"location":"disconnect-hvserver/","title":"Disconnect-HVServer","text":"<p>This cmdlet disconnects the connection to a Horizon API service that runs on an instance of the Horizon Connection server specified by the <code>-Server</code> parameter. When there are no active connections to the server, the server is disconnected and removed from the <code>$DefaultHVServers</code> variable. For more information about this variable, see Connect-HVServer.</p> <p>When no server and no user parameter is specified, and if there is only one connected server in the <code>$DefaultHVServers</code> variable, this server is disconnected. If there is no connected server or multiple servers, the cmdlet throws a terminating error. This functionality uses the reference counting mechanism. A disconnect decreases the RefCount for that server. For more information about the mechanism, see Connect-HVServer.</p> <p>If <code>-Force</code> is specified, the server is disconnected even if there is more than one connection to it.</p>"},{"location":"disconnect-hvserver/#syntax","title":"Syntax","text":"Default <pre><code>  Disconnect-HVServer [-Force]\n                      [-Server  &lt;ViewServer[]&gt;]\n                      [CommonParameters]\n</code></pre>"},{"location":"disconnect-hvserver/#parameters","title":"Parameters","text":"Required Parameter Name Type Position Features Description optional Force SwitchParameter named Specifies that you want to remove all existing connections to the specified servers. optional Server ViewServer[] named pipeline Specifies the Horizon API service that runs on an instance of a Horizon Connection server that you want to disconnect from."},{"location":"disconnect-hvserver/#output","title":"Output","text":"<p>VMware.VimAutomation.HorizonView.Types.V1.ViewServer</p>"},{"location":"disconnect-hvserver/#examples","title":"Examples","text":""},{"location":"disconnect-hvserver/#example-1","title":"Example 1","text":"<p><code>$HVServer = Connect-HVServer -Server server; Disconnect-HVServer -server $HVServer</code> Disconnects the connection to the specified Horizon API service that runs on an instance of a Horizon Connection server.</p>"},{"location":"disconnect-hvserver/#example-2","title":"Example 2","text":"<p><code>$HVServer = Connect-HVServer -Server server; Disconnect-HVServer -Force *</code> Disconnects all connected Horizon API services that run on instances of Horizon Connection servers.</p>"},{"location":"disconnect-hvserver/#related-commands","title":"Related Commands","text":""},{"location":"disconnect-hvserver/#hvserver","title":"HVServer","text":"<p>Connect-HVServer This cmdlet establishes a connection to the Horizon API service that runs on an instance of the Horizon Connection server.</p>"}]}